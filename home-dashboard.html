<head>
	<title>Fort Borilliam</title>
	<script>
		function redisplayDiffTimes() {
			$('span[data-time]').each(function (index, value) {
				this.innerText = formatDate(parseInt(value.getAttribute('data-time')));
			});
		}
		$(function () {
			window.setInterval(redisplayDiffTimes, 2000);
		});
	</script>
</head>

<body>
	<div class="messages span6">
		<h1>Fort Borilliam</h1>
		{{> messages}}
	</div>
</body>

<template name="messages">
<div class="row-fluid">
	{{loginButtons}}
</div>
{{#if messages}}
<ul class="unstyled">
	{{#each messages}}
		{{> message}}
	{{/each}}
</ul>
{{else}}
	No messages.
{{/if}}
{{#if currentUser}}
	{{> send-message}}
{{/if}}
</template>

<template name="send-message">
	<form onsubmit="event.preventDefault();" class="form-horizontal">
		<input type="text" name="new-message"></input>
		<input class="btn" type="button" name="send" value="Send"></input>
	</form>
	<input class="btn" type="button" name="deleteAll" value="Delete"></input>
</template>

<template name="message">
<li class="message media">
	<div class="pull-left">
		<img class="img-circle" src="{{getAuthorImage author}}" />
	</div>
	<div class="media-body">
		<div class="media-heading">
			<span class="author">
				<strong>{{author.profile.name}}</strong>
			</span>
			<span class="time muted pull-right">
				<span data-time="{{timestamp}}">{{date-render timestamp}}</span>
			</span>
		</div>
		{{msg}}
	</div>
</li>
</template>
