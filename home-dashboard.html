<head>
	<title>Fort Borilliam</title>
	<script>
		function redisplayDiffTimes() {
			$('span[data-time]').each(function (index, value) {
				this.innerText = formatDate(parseInt(value.getAttribute('data-time')));
			});
		}
		$(function () {
			window.setInterval(redisplayDiffTimes, 2000);
		});
	</script>
</head>

<body>
	<h1>Fort Borilliam</h1>
	<div class="messages">
		{{> messages}}
	</div>
</body>

<template name="messages">
{{loginButtons}}
{{#if messages}}
<ul>
	{{#each messages}}
		{{> message}}
	{{/each}}
</ul>
{{else}}
	No messages.
{{/if}}
{{#if currentUser}}
	{{> send-message}}
{{/if}}
</template>

<template name="send-message">
	<form onsubmit="event.preventDefault();" class="form-horizontal">
		<input type="text" name="new-message"></input>
		<input class="btn" type="button" name="send" value="Send"></input>
	</form>
	<input class="btn" type="button" name="deleteAll" value="Delete"></input>
</template>

<template name="message">
	<li>
		<em><span data-time="{{timestamp}}">{{date-render timestamp}}</span></em> [{{author.profile.name}}] {{msg}}
	</li>
</template>
